# 자동 테스트

- 테스트에는 수동 테스트와 자동 테스트가 있는데, 수동 테스트는 사람이 직접 하나하나 클릭해보면서 테스트를 하는 것입니다. 반면 자동 테스트는 테스트 코드나 자동화된 스크립트를 통해 테스트를 진행하는 것입니다.
- 수동 테스트는 시간이 흐를수록 테스트에 대한 비용이 비싸지며, 새로운 기능을 배포하더라도 이전 기능도 테스트를 해야합니다. 왜냐하면 이전 기능들이 정상적으로 동작할지는 아무도 모르기 때문입니다.

<br>

## 1. Regression(회귀: 되돌아갔다)

- 소프트웨어 분야에서 Regression이란 '시스템에서 정상적으로 작동했던 기능이 어떤 배포 시점을 기준으로 제대로 동작하지 않게 되는 상황'입니다.

#### 💡 Regression Bug는 어떻게 헤결할 수 있을까?

- 테스트 코드를 꼼꼼히 작성하면 됩니다. 테스트를 이용해서 코드가 초기 개발 의도를 잘 지키고 있는지 검사하면 됩니다. 이러한 회귀 버그를 탐자히고자 만들어진 테스트 코드를 회귀 테스트라고 합니다.

#### 상황

- 예를들어 조직에 새로운 팀원이 합류하여 새로운 팀원이 기능을 개발하고, 운영에 배포할 때 기존 서비스에 영향을 주면 어떡하지? 라는 생각을 할 수도 있습니다.
그리고 만약 문제가 발생하면 이때 새로운 팀원의 능력이 부족해서 문제가 발생하는게 아닙니다. 왜냐면 프로젝트는 그동안 성장하면서 암묵적인 약속이나 맥락이 생기는 경우가 많기 때문에 새로운 팀원은 그것을 모르는 경우가 많습니다.
그리고 새로운 팀원은 소극적으로 변하고, 자신감이 많이 없어지겠죠.
- 하고싶은 말은 테스트를 사전에 잘 작성하자 입니다. 테스트가 누적되다보면 맥락을 알 수 있고, 암묵적인 약속을 커버할 수 있기 때문입니다. 
그리고 커버리지 100%가 중요한게 아닙니다. 그냥 테스트를 통해서 안정감을 느낄 수 있다면 충분합니다.

<br>

## 2. 의도

- 누군가 작성한 코드를 수정할 때 기존의 의도에 맞지 않게 코드를 수정할 수도 있습니다. 그리고 똑같이 회귀 버그가 발생할 수 있죠.

#### 상황

- 아래 코드에서 userRepository의 findById() 메서드를 호출하고 있고, 더 이상 해당 객체를 사용하는 곳이 없다고 판단하여 해당 라인을 삭제하면 어떻게 될까요?
그리고 나중에 해당 메서드 내부에서 특정 사용자가 없으면 예외가 발생하는 로직을 알았다고 한다면 똑같이 회귀 버그가 발생하게 됩니다.

```java
public void something(long userId) {
    userRepository.findById(userId); // 호출만 할 뿐 사용되는 곳이 없음

    // 이하 생략
}
```

<br>

#### 서로 다른 의도

- 기존 코드 작성자는 findById() 메서드를 호출함으로써 특정 사용자에 대한 '유효성 검증' 로직을 추가한 것이고 코드 수정자는 이 의도를 몰랐던 것입니다.

#### 🧐 어떻게 해결할 수 있을까?

- 이 또한 테스트 코드를 작성해 놓음으로써 문제를 해결할 수 있습니다.
- 만약 코드 수정자가 findById() 메서드를 호출하는 라인을 삭제하면 테스트 코드를 통해서 호출한 문맥을 알 수 있게 됩니다.

```java
public void SampleTest {

    @Test
    void something_메서드에서_특정_사용자가_없으면_예외가_발생한다() {
         // given
         long userId = 1L;

         // when && then
         assertThatThrownBy(() -> userService.something(userId))
             .isInstanceOf(UserNotFoundException.class);
    }
}
```

<br>

## 3. 레거시 코드

- 레거시 코드가 단순히 오래된 코드인가요? 오래된 코드라면 1년전 코드인가요? 2년전 코드인가요?

#### 마이클 패더스가 말한 레거시 코드

- 마이클 패더스라는 사람은 레거시 코드를 가리켜 테스트 코드가 없는 코드가 레거시 코드라고 말하였습니다. 그의 정의에 따르면 어제 작성한 코드라도 테스트 코드가 없다면 레거시 코드인것 입니다.
- 이 정의는 매우 간결하면서도 명쾌합니다. 또한 레거시 코드가 가지고 있는 본질적인 문제점을 강조하고 있으며, 이해하기 어렵고, 변경하기 어렵고, 의도가 명확하지 않고 이러한 문제가 있는 코드에 테스트 코드를 작성함으로써 해결할 수 있다는 것이죠.

<br>

#### 개인적인 생각

- 테스트 코드는 정말 중요하고, 가끔 귀찮고, 때로는 어렵지만 꾸준히 작성하려는 마음가짐이 중요하다..!



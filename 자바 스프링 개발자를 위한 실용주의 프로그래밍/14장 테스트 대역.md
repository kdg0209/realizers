# í…ŒìŠ¤íŠ¸ ëŒ€ì—­(Test Double)

- í…ŒìŠ¤íŠ¸ ëŒ€ì—­ì´ë€ ì˜¤ë¡¯ì´ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ë§Œë“¤ì–´ì§„ ì§„ì§œê°€ ì•„ë‹Œ ê°€ì§œ ê°ì²´ë‚˜ ì»´í¬ë„ŒíŠ¸ë¥¼ ê°€ë¦¬í‚¤ëŠ” ìš©ì–´ì…ë‹ˆë‹¤.

#### ğŸ§ ì–¸ì œ í…ŒìŠ¤íŠ¸ ëŒ€ì—­ì„ ì‚¬ìš©í•˜ëŠ”ê°€?

- í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•˜ë‹¤ë³´ë©´ í…ŒìŠ¤íŠ¸ ë‹¨ê³„ì—ì„œ ì‹¤ì œ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ê¸° ë¶€ë‹´ìŠ¤ëŸ¬ìš´ ê²½ìš°ì…ë‹ˆë‹¤.

#### ì˜ˆì œ ì½”ë“œ

- ì•„ë˜ ì˜ˆì œ ì½”ë“œëŠ” íšŒì›ê°€ì…ì‹œ íšŒì›ì˜ ìƒíƒœë¥¼ 'PENDING'ìœ¼ë¡œ ë‘ê³  ì´ë©”ì¼ ë°œì†¡ì„ í†µí•´ ì¸ì¦ì„ í•˜ëŠ” ê°„ë‹¨í•œ ë¡œì§ì…ë‹ˆë‹¤.

```java
@Service
@Transactional
@RequiredArgsConstructor
public class UserCreateService {

    private final EmailSender emailSender;
    private final UserRepository userRepository;

    public User create(String email, String name) {
        User user = new User(email, name, UserStatus.PENDING);

        userRepository.save(user);
        emailSender.send(user);
        
        return user;
    }
}

public interface EmailSender {

    void send(User user);
}

public class VerificationEmailSender implements EmailSender {

    @Override
    public void send(User user) {
        // do something
    }
}

public interface UserRepository {

    void save(User user);
}

public class UserRepositoryImpl implements UserRepository {

    @Override
    public void save(User user) {
        // do something
    }
}
```

<br>

#### ğŸ§ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì–´ë–»ê²Œ ì‘ì„±í• ê¹Œ?

- @SpringBootTest ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì—¬ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ë„ ìˆê³ , ì•„ë˜ì²˜ëŸ¼ ì‘ì„±í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
- ë§Œì•½ @SpringBootTest ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì—¬ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¥¼ ì´ˆê¸°í™”í•˜ê³ , í•„ìš”í•œ ì˜ì¡´ì„±ì„ ì£¼ì…ë°›ê³  ì‹¤ì œë¡œ ì´ë©”ì¼ì„ ë°œì†¡í•˜ê¸°ê¹Œì§€ì˜ ë¡œì§ì„ í…ŒìŠ¤íŠ¸ ì½”ë“œë¡œ ì‘ì„±í•  ìˆ˜ ìˆëŠ”ë°, ê·¸ëŸ¬í•œ ë°©ë²•ì—ëŠ” ë¬¸ì œì ì´ ìˆìŠµë‹ˆë‹¤.
  - ì‹¤ì œë¡œ ì´ë©”ì¼ì´ ë°œì†¡ë˜ë©´ ì–´ë–¡í•˜ì§€?
  - ì´ë©”ì¼ì´ ë°œì†¡ëœë‹¤ê³  í•˜ë©´ ëˆ„êµ¬ì—ê²Œ ë°œì†¡í•´ì•¼í•˜ì§€?
  - ê°„í˜¹ê°€ë‹¤ ì´ë©”ì¼ ë°œì†¡ì— ë¬¸ì œê°€ ë°œìƒí•˜ë©´ ì–´ë–¡í•˜ì§€?
  - ì¦‰, ë•Œë¡  ë¹„ê²°ì •ì  í…ŒìŠ¤íŠ¸ê°€ ë  ìˆ˜ ìˆê³ , ì†ë„ë„ ëŠë ¤ì§‘ë‹ˆë‹¤.

```java
public class DummyEmailSender implements EmailSender {

    @Override
    public void send(User user) {
        // do something
    }
}

class UserCreateServiceTest {

    @Test
    void íšŒì›ê°€ì…ì„_í•˜ë©´_ë³´ë¥˜_ìƒíƒœê°€_ë˜ê³ _ì´ë©”ì¼ì„_ë°œì†¡í•œë‹¤() {

        // given
        String email = "test@naver.com";
        String name = "í™ê¸¸ë™";

        // when
        UserCreateService userCreateService = new UserCreateService(new DummyEmailSender(), new UserRepositoryImpl());
        User user = userCreateService.create(email, name);

        // then
        assertThat(user.getStatus()).isEqualTo(UserStatus.PENDING);
    }
}
```

<br>

#### ğŸ’¡ í…ŒìŠ¤íŠ¸ ëŒ€ì—­ë„ ì •ë‹µì€ ì•„ë‹™ë‹ˆë‹¤.

- ëª¨ë“ ê±¸ í…ŒìŠ¤íŠ¸ ëŒ€ì—­ìœ¼ë¡œ í•˜ê³ ì‹¶ì€ ìœ í˜¹ì´ ìŠ¤ë©€ìŠ¤ë©€ ì˜¬ë¼ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ í…ŒìŠ¤íŠ¸ ëŒ€ì—­ë„ ì ë‹¹íˆ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ ì´ìœ ëŠ” í…ŒìŠ¤íŠ¸ ëŒ€ì—­ì„ ë‚¨ìš©í•˜ë©´ í…ŒìŠ¤íŠ¸ê°€ ì ì  ì‹¤ì œ êµ¬í˜„ê³¼ ê±°ë¦¬ê°€ ë©€ì–´ì§€ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

<br>

## 1. Dummy

- Dummyì˜ ì—­í• ì€ ì•„ë¬´ëŸ° ë™ì‘ì„ í•˜ì§€ ì•ŠëŠ” ê²ƒì…ë‹ˆë‹¤.
- Dummy ê°ì²´ëŠ” ì˜¤ë¡¯ì´ ì½”ë“œê°€ ì •ìƒì ìœ¼ë¡œ ëŒì•„ê°€ê²Œ í•˜ê¸° ìœ„í•œ ì—­í• ë§Œ ìˆ˜í–‰í•©ë‹ˆë‹¤.

#### ì˜ˆì œ ì½”ë“œ

- ì•„ë˜ ì˜ˆì œì½”ë“œëŠ” Filterë¥¼ ì¶”ê°€í•˜ê³  ì¶”ê°€í•œ í•„í„°ë¥¼ í…ŒìŠ¤íŠ¸í•˜ê³ ì í•©ë‹ˆë‹¤. ì´ë•Œ @WebMvcTest ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ì—¬ í…ŒìŠ¤íŠ¸í•  ìˆ˜ë„ ìˆì§€ë§Œ ë” ê°„ë‹¨í•œ ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤.

```java
public class SomethingFilter extends GenericFilterBean {

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
        
        // textë¥¼ ìš”ì²­í•˜ëŠ” requestë¼ë©´ ì‘ë‹µì˜ Context-Typeì„ "text/plain"ìœ¼ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.
        if (request.getAttribute("giveMe").equals("text")) {
            response.setContentType("text/plain");
        }
        
        chain.doFilter(request, response);
    }
}
```

#### í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±

- ì•„ë˜ FilterChainì˜ ìµëª… í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ Dummyë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```java
class SomethingFilterTest {

    @Test
    void ìš”ì²­ì—_text_ë¡œ_ë‹¬ë¼ëŠ”_ìš”ì²­ì´_ìˆìœ¼ë©´_ì‘ë‹µì˜_ì½˜í…ì¸ _íƒ€ì…ì€_text_plain_ì´ë‹¤() throws IOException, ServletException {

        // given
        MockHttpServletRequest request = new MockHttpServletRequest();
        request.setAttribute("giveMe", "text");
        MockHttpServletResponse response = new MockHttpServletResponse();

        // when
        SomethingFilter filter = new SomethingFilter();
        filter.doFilter(request, response, new FilterChain() {
            @Override
            public void doFilter(ServletRequest request, ServletResponse response) throws IOException, ServletException {
                // dummy
            }
        });

        // then
        assertThat(response.getContentType()).isEqualTo("text/plain");
    }
}
```

<br>

## 2. Stub

- Stubì€ ì›ë³¸ ê°ì²´ì˜ ì‘ë‹µì„ ë³µì œí•´ ë˜‘ê°™ì€ ì‘ë‹µìœ¼ë¡œ ë¯¸ë¦¬ ì¤€ë¹„í•˜ê³  ì´ë¥¼ ë°˜í™˜í•˜ëŠ” ì—­í• ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
- ì¦‰, ë¯¸ë¦¬ ì¤€ë¹„ëœ ê°’ì„ ë°˜í™˜í•˜ëŠ” ëŒ€ì—­ ê°ì²´ì…ë‹ˆë‹¤.

#### ì˜ˆì œ ì½”ë“œ

- ì˜ˆì œ ì½”ë“œëŠ” íšŒì›ê°€ì…ì‹œ ì´ë©”ì¼ì˜ ìœ íš¨ì„± ê²€ì¦ì„ í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

```java
@Service
@Transactional
@RequiredArgsConstructor
public class UserCreateService {

    private final EmailSender emailSender;
    private final UserRepository userRepository;

    public User create(String email, String name) {
        boolean duplicatedEmail = userRepository.hasDuplicatedEmail(email);
        if (duplicatedEmail) {
            throw new IllegalStateException("í•´ë‹¹ ì´ë©”ì¼ì€ ì´ë¯¸ ì‚¬ìš©ì¤‘ì…ë‹ˆë‹¤.");
        }
        
        User user = new User(email, name, UserStatus.PENDING);

        userRepository.save(user);
        emailSender.send(user);

        return user;
    }
}
```

#### í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±

- ë°ì´í„°ë² ì´ìŠ¤ì™€ ì—°ë™í•˜ëŠ” ê²ƒì€ ë„¤íŠ¸ì›Œí¬ í˜¸ì¶œê³¼ ë””ìŠ¤í¬ I/O, ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ì´ˆê¸°í™” ë“±ìœ¼ë¡œ ì¸í•´ ë¬´ê±°ìš´ ì‘ì—…ì´ì§€ë§Œ ì•„ë˜ ì½”ë“œë¥¼ ë³´ë©´ ê·¸ëŸ¬í•œ ì½”ë“œê°€ ì—†ìŠµë‹ˆë‹¤.! ë˜í•œ ì¤‘í˜• í…ŒìŠ¤íŠ¸ê°€ ì†Œí˜• í…ŒìŠ¤íŠ¸ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤!!
- í•˜ì§€ë§Œ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€ì ìœ¼ë¡œ ë§Œë“¤ì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ê´€ë¦¬ ë¶€ë¶„ì´ ì¦ê°€í•˜ê²Œ ë©ë‹ˆë‹¤.

```java
public class StubNotDuplicatedEmailUserRepository implements UserRepository {

    @Override
    public boolean hasDuplicatedEmail(String email) {
        return false;
    }

    @Override
    public User save(User user) {
        return new User(user.getEmail(), user.getName(), user.getStatus());
    }
}

public class StubDuplicatedEmailUserRepository implements UserRepository {

    @Override
    public boolean hasDuplicatedEmail(String email) {
        return true;
    }

    @Override
    public User save(User user) {
        return new User(user.getEmail(), user.getName(), user.getStatus());
    }
}

class UserCreateServiceTest {

    @Test
    void ì¤‘ë³µëœ_ì´ë©”ì¼ì„_ì‚¬ìš©í•˜ì—¬_íšŒì›ê°€ì…ì„_í•˜ë©´_ì˜ˆì™¸ê°€_ë°œìƒí•œë‹¤() {

        // given
        String email = "test@naver.com";
        String name = "í™ê¸¸ë™";
        UserCreateService createService = new UserCreateService(new DummyEmailSender(), new StubDuplicatedEmailUserRepository());

        // when && then
        assertThatThrownBy(() -> createService.create(email, name))
                .isInstanceOf(IllegalStateException.class);
    }

    @Test
    void ì¤‘ë³µë˜ì§€_ì•Šì€_ì´ë©”ì¼ì„_ì‚¬ìš©í•˜ë©´_ì •ìƒì ìœ¼ë¡œ_íšŒì›ê°€ì…ì„_í• _ìˆ˜_ìˆë‹¤() {

        // given
        String email = "test@naver.com";
        String name = "í™ê¸¸ë™";
        UserCreateService createService = new UserCreateService(new DummyEmailSender(), new StubNotDuplicatedEmailUserRepository());

        // when
        User result = createService.create(email, name);

        // then
        assertThat(result.getStatus()).isEqualTo(UserStatus.PENDING);
    }
}
```

<br>

## 3. Fake

- FakeëŠ” ìì²´ì ì¸ ë…¼ë¦¬ë¥¼ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.
- Stubì„ ì‚¬ìš©í•˜ë©´ í´ë˜ìŠ¤ê°€ ì¦ê°€ëœë‹¤ëŠ” ê²ƒì„ ì•Œê²Œë˜ì—ˆìŠµë‹ˆë‹¤. FakeëŠ” Stubì˜ ë‹¨ì ì„ ë³´ì™„í•´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- Stub ì½”ë“œë¥¼ ì‘ì„±í•˜ë‹¤ë³´ë©´ Stub ê°ì²´ë¥¼ ì–´ë–»ê²Œ ë§Œë“¤ì–´ì•¼í• ê¹Œ, ì–´ë–»ê²Œ ì˜ì¡´ì„± ì£¼ì…ì„ í•´ì•¼í• ê¹Œ ìƒê°í•˜ê²Œ ë˜ê³ , ì´ëŠ” í…ŒìŠ¤íŠ¸ëŠ” ìµœëŒ€í•œ ê°„ê²°í•˜ê³  ë³´ìë§ˆì ì´í•´ ê°€ëŠ¥í•´ì•¼ í•˜ëŠ”ë°, Stubìœ¼ë¡œ ì¸í•´ ì¤‘ìš”í•œ ë¶€ë¶„ì„ ê°€ë¦¬ê²Œ ë˜ê³ , í…ŒìŠ¤íŠ¸ì˜ ëª©ì ì´ ë¬´ì—‡ì¸ì§€ í•œëˆˆì— íŒŒì•…í•˜ê¸° ì–´ë ¤ì›Œì§ˆ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

#### ì˜ˆì œ ì½”ë“œ

- ì˜ˆì œ ì½”ë“œëŠ” ìœ„ì™€ ë™ì¼í•©ë‹ˆë‹¤.

```java
@Service
@Transactional
@RequiredArgsConstructor
public class UserCreateService {

    private final EmailSender emailSender;
    private final UserRepository userRepository;

    public User create(String email, String name) {
        boolean duplicatedEmail = userRepository.hasDuplicatedEmail(email);
        if (duplicatedEmail) {
            throw new IllegalStateException("í•´ë‹¹ ì´ë©”ì¼ì€ ì´ë¯¸ ì‚¬ìš©ì¤‘ì…ë‹ˆë‹¤.");
        }

        User user = new User(1L, email, name, UserStatus.PENDING);

        userRepository.save(user);
        emailSender.send(user);

        return user;
    }
}
```

#### í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±

- FakeUserRepository í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ë‘ ê°€ì§€ì˜ Stub ê°ì²´ë¥¼ ë§Œë“¤ì§€ ì•Šì•„ë„ ëœë‹¤ëŠ” ê²ƒì„ ì•Œê²Œë˜ì—ˆìŠµë‹ˆë‹¤. ë˜í•œ ìì²´ì ì¸ ë¹„ì§€ë‹ˆìŠ¤ ë…¼ë¦¬ë¥¼ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— ì¬ì‚¬ìš©ì„±ì´ ë†’ì•„ì¡ŒìŠµë‹ˆë‹¤.

```java
public class DummyEmailSender implements EmailSender {

    @Override
    public void send(User user) {
        // do something
    }
}

public class FakeUserRepository implements UserRepository {

    private long autoGeneratedId = 0;
    private final List<User> users = new ArrayList<>();

    @Override
    public boolean hasDuplicatedEmail(String email) {
        return this.users.stream()
                .anyMatch(user -> user.getEmail().equals(email));
    }

    @Override
    public User save(User user) {
        // create ë™ì‘
        if (user.getId() == null || user.getId() == 0L) {
            User newUser = new User(++autoGeneratedId, user.getEmail(), user.getName(), user.getStatus());
            this.users.add(newUser);
            return newUser;
        }

        // update ë™ì‘
        this.users.removeIf(it -> it.getId().equals(user.getId()));
        this.users.add(user);
        return user;
    }
}

class UserCreateServiceTest {

    @Test
    void ì¤‘ë³µëœ_ì´ë©”ì¼ì„_ì‚¬ìš©í•˜ì—¬_íšŒì›ê°€ì…ì„_í•˜ë©´_ì˜ˆì™¸ê°€_ë°œìƒí•œë‹¤() {

        // ë°ì´í„° ë¯¸ë¦¬ ì„¸íŒ…
        FakeUserRepository fakeUserRepository = new FakeUserRepository();
        fakeUserRepository.save(new User(1L, "test@naver.com", "í™ê¸¸ë™", UserStatus.PENDING));

        // given
        String email = "test@naver.com";
        String name = "í™ê¸¸ë™";
        UserCreateService userCreateService = new UserCreateService(new DummyEmailSender(), fakeUserRepository);

        // when && then
        assertThatThrownBy(() -> userCreateService.create(email, name))
                .isInstanceOf(IllegalStateException.class);
    }

    @Test
    void ì¤‘ë³µë˜ì§€_ì•Šì€_ì´ë©”ì¼ì„_ì‚¬ìš©í•˜ë©´_ì •ìƒì ìœ¼ë¡œ_íšŒì›ê°€ì…ì„_í• _ìˆ˜_ìˆë‹¤() {

        // ë°ì´í„° ë¯¸ë¦¬ ì„¸íŒ…
        FakeUserRepository fakeUserRepository = new FakeUserRepository();
        fakeUserRepository.save(new User(1L, "test@naver.com", "í™ê¸¸ë™", UserStatus.PENDING));

        // given
        String email = "test@gmail.com";
        String name = "í™ê¸¸ë™";
        UserCreateService userCreateService = new UserCreateService(new DummyEmailSender(), fakeUserRepository);

        // when
        User result = userCreateService.create(email, name);

        // then
        assertThat(result.getStatus()).isEqualTo(UserStatus.PENDING);
    }
}
```

<br>

## 4. Mock

- ì£¼ë¡œ ë©”ì„œë“œ í˜¸ì¶œì´ ë°œìƒí–ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ê²€ì¦í•˜ëŠ” ì—­í• ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
- Mockotoë¥¼ ì‚¬ìš©í•˜ë©´ êµ¬í˜„ì´ ì—†ëŠ” ê°ì²´(Dummy)ë¥¼ ë§Œë“¤ ìˆ˜ë„ ìˆìœ¼ë©°, íŠ¹ì • ê°ì²´ì˜ ë©”ì„œë“œ í˜¸ì¶œì„ ì‹œë®¬ë ˆì´ì…˜ í•˜ëŠ” ê°ì²´(Stub)ì„ ë§Œë“¤ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
- Dummyë„ Mockì´ê³ , Stubë„ Mockì´ê³ , Fakeë„ Mockì´ë¼ê³  í˜¼ë™í•  ìˆ˜ ìˆëŠ”ë°, ê°ê° êµ¬ë³„í•´ì•¼ í•©ë‹ˆë‹¤. Mockì€ ì´ëŸ¬í•œ í…ŒìŠ¤íŠ¸ ëŒ€ì—­ë“¤ì˜ ë¶€ë¶„ ì§‘í•©ì¼ ë¿ì…ë‹ˆë‹¤.

### ìƒíƒœ ê¸°ë°˜ ê²€ì¦

- ë¸”ë™ ë°•ìŠ¤ í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤.
- ìƒíƒœ ê¸°ë°˜ ê²€ì¦ì´ë€ í…ŒìŠ¤íŠ¸ì˜ ê²€ì¦ ë™ì‘ì— ìƒíƒœë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
- ì¦‰, ìƒíƒœ ê¸°ë°˜ ê²€ì¦ìœ¼ë¡œ ë™ì‘í•˜ëŠ” í…ŒìŠ¤íŠ¸ì—ì„œëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•œ í›„ í…ŒìŠ¤íŠ¸ ëŒ€ìƒì˜ ìƒíƒœê°€ ì–´ë–»ê²Œ ë³€í™”ëëŠ”ì§€ë¥¼ ë³´ê³  í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ íŒë‹¨í•˜ê²Œ ë©ë‹ˆë‹¤.
- ë§ˆì¹˜ ì•„ë˜ ì½”ë“œì™€ ê°™ìŠµë‹ˆë‹¤.

```java
@Test
void ì¤‘ë³µë˜ì§€_ì•Šì€_ì´ë©”ì¼ì„_ì‚¬ìš©í•˜ë©´_ì •ìƒì ìœ¼ë¡œ_íšŒì›ê°€ì…ì„_í• _ìˆ˜_ìˆë‹¤() {

    // given
    String email = "test@naver.com";
    String name = "í™ê¸¸ë™";
    UserCreateService createService = new UserCreateService(new DummyEmailSender(), new StubNotDuplicatedEmailUserRepository());

    // when
    User result = createService.create(email, name);

    // then
    // ìƒíƒœê°€ íŠ¹ì • ìƒíƒœì™€ ê°™ì€ì§€ ê²€ì¦í•©ë‹ˆë‹¤.
    assertThat(result.getStatus()).isEqualTo(UserStatus.PENDING);
}
```

<br>

### í–‰ìœ„ ê¸°ë°˜ ê²€ì¦

- í™”ì´íŠ¸ ë°•ìŠ¤ í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤.
- í–‰ìœ„ ê¸°ë°˜ ê²€ì¦ì€ í…ŒìŠ¤íŠ¸ì˜ ê²€ì¦ ë™ì‘ì— íŠ¹ì • ë©”ì„œë“œê°€ í˜¸ì¶œë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

```java
@Test
void ì¤‘ë³µë˜ì§€_ì•Šì€_ì´ë©”ì¼ì„_ì‚¬ìš©í•˜ë©´_ì •ìƒì ìœ¼ë¡œ_íšŒì›ê°€ì…ì„_í• _ìˆ˜_ìˆë‹¤() {

    // given
    String email = "test@naver.com";
    String name = "í™ê¸¸ë™";
    UserCreateService createService = new UserCreateService(new DummyEmailSender(), new StubNotDuplicatedEmailUserRepository());

    // when
    User result = createService.create(email, name);

    // then
    // íŠ¹ì • ë©”ì„œë“œê°€ í˜¸ì¶œë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
    verify(userRepository, times(1)).hasDuplicatedEmail();
    verify(userRepository, times(1)).save();
    verify(emailSender, times(1)).send();
}
```

#### ìƒíƒœ ê¸°ë°˜ Vs í–‰ìœ„ ê¸°ë°˜

- ìƒíƒœ ê¸°ë°˜ì€ ì‹œìŠ¤í…œì˜ ë‚´ë¶€ ë°ì´í„° ìƒíƒœë¥¼ ê²€ì¦í•˜ëŠ” í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤.
- í–‰ìœ„ ê¸°ë°˜ì€ ì‹œìŠ¤í…œì˜ ë‚´/ì™¸ë¶€ ë™ì‘ì„ ê²€ì¦í•˜ëŠ” í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤.

#### ğŸ§ ë‚´ê°€ ì„ í˜¸í•˜ëŠ” í…ŒìŠ¤íŠ¸ ë°©ì‹

- í–‰ìœ„ ê¸°ë°˜ì€ ìš°ì„  í™”ì´íŠ¸ ë°©ì‹ í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤. ì €ëŠ” ì´ ë°©ì‹ì€ ìº¡ìŠí™”ë¥¼ ê¹¨íŠ¸ë¦°ë‹¤ê³  ìƒê°í•˜ê³  ìˆìœ¼ë©°, ìƒíƒœ ê¸°ë°˜ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼ í•œë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤.

<br>

## 5. Spy

<br>

#### ì •ë¦¬

- í…ŒìŠ¤íŠ¸ ëŒ€ì—­ì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ëŒ€í˜•, ì¤‘í˜• í…ŒìŠ¤íŠ¸ê°€ ì†Œí˜• í…ŒìŠ¤ë¡œ ë¹„ê¿€ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.
- ëŒ€í˜•, ì¤‘í˜•, ì†Œí˜• í…ŒìŠ¤íŠ¸ëŠ” í…ŒìŠ¤íŠ¸ í•˜ë ¤ëŠ” ëŒ€ìƒì— ë”°ë¼ ê²°ì •ë˜ëŠ”ê²Œ ì•„ë‹ˆë¼, í…ŒìŠ¤íŠ¸ í™˜ê²½ì„ ì–´ë–»ê²Œ êµ¬ì„±í•˜ëŠëƒì— ë”°ë¼ ê²°ì •ë©ë‹ˆë‹¤.








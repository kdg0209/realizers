# 마이크로서비스 아키텍처와 레디스

<br>

## 모놀리틱 아키텍처

- 모놀리틱 아키텍처는 전체 애플리케이션을 하나의 패키지로 관리하는 방식입니다.

#### 💡 장점

- 작은 규모의 프로젝트나 애플리케이션에 적합한 아키텍처입니다.
- 단일 프로젝트로 배포하기 때문에 새로운 기능을 추가하거나 버그를 수정할 때 배포가 쉬울 수 있습니다.
- 팀의 인원이 소규모이거나 빠르게 개발해야할 때 용이할 수 있습니다.

#### 🧨 단점

- 서비스의 규모가 커지고 유지보수의 복잡성이 증가될 수 있습니다.
- 하나의 모듈을 수정하면 전체 애플리케이션을 재배포해야합니다.
- 대량의 트래픽 및 복잡한 요구사항, 트랜잭션에 유연하게 대처하기 힘들 수 있습니다.
- 한 개의 시스템에 문제가 발생하면 전체 애플리케이션 장애로 번질 수 있습니다.

#### 언제 모놀리틱 아키텍처를 사용해야할까?

- 규모가 작은 애플리케이션일 경우
- 팀의 규모가 작거나, 신생팀일 경우 또는 도메인 지식이 없는 새로운 도메인일 경우
- 재품이 MVP 단계일 경우

#### 🤔 모놀리틱 아키텍처에 대한 개인적인 생각

- 프로젝트를 처음 시작하는 경우 해당 프로젝트가 성공할지 실패할지는 그 누구도 모른다고 생각합니다. 그렇기 때문에 대부분의 프로젝트는 모놀리틱 아키텍처를 기반으로 시작하게 될 텐데, 그래도 처음부터 어느정도의 멀티 모듈 기반으로 프로젝트를 구성한다면 후에 마이크로서비스 아키텍처로 전환한다던가
특정 프로젝트를 분리해야할 경우 용이할 수 있습니다. 하지만 하나의 모듈로 구성이 되어 있는 상황에서 멀티 모듈로 변경하고자 한다면 어떻게 할 수 있을까? 라는 고민을 가끔하곤 하는데 의존성이 관리되어 있는 않은 상황에서 무엇부터 모듈화를 진행해야할까? 
그리고 ...

<br>

## 마이크로서비스 아키텍처

- 마이크로서비스 아키텍처는 독립된 각각의 모듈을 조합해 하나의 서비스를 만드는 방식입니다.

#### 💡 장점

- 독립된 모듈이기 때문에 하나의 애플리케이션 내의 특정 서비스의 규모가 커져 해당 서비스의 확장이 필요할 때 원하는 서비스의 서버만 독립적으로 확장할 수 있습니다.
- 각 서비스간 느슨한 결합을 통해 독립적으로 배포할 수 있습니다.
- 특정 서비스가 중단되더라도 전체 애플리케이션에 영향을 미치지 않고 다른 서비스들은 정상적으로 수행될 수 있습니다.

#### 🧨 단점

- 개발의 생산성이 낮아질 수 있습니다. 하나의 모듈에 새로운 기능을 추가하더라도 다른 모듈에 접근할 경우 또는 로컬에 환경을 구축할 경우입니다.
- 각 모듈간 동기 통신을 할건지 비동기 통신을 할건지 고려해야 하며, 이는 복잡성을 증가시킬 수 있습니다.
- 오류 처리에 대해 고민해야할 점이 증가합니다.

<br>

## 데이터 저장소의 요구 사항 변화

- 최근에는 데이터가 정해진 형태가 없고, 크기와 구조를 예측할 수 없는 비정형 데이터가 증가하고 있습니다. 이러한 비정형 데이터는 다차원적이거나 깊은 계층 구조를 가지고 있어 RDBMS에서는 관리하기 어렵습니다.

<br>

## NoSQL이란?

- NoSQL이란 용어는 No SQL 혹은 Not Only SQL을 의미합니다.
- NoSQL은 다양한 데이터 저장 유형을 제공하고 있습니다.
  - 그래프 유형 (추천 서비스)
  - 컬럼 유형 (NoSQL은 행이 아닌 열을 기준으로 저장됩니다)
  - 문서 유형
  - key-value 유형

<br>

## 레디스란?

- Remote Dictionary Server의 약자로 고성능 key-value 유형의 고성능 인 메모리 NoSQL 데이터베이스입니다.

### 레디스의 특징

#### 빠른 성능

- MySQL 같은 온디스크 데이터베이스는 데이터를 영구적으로 디스크에 저장합니다. 자주 사용되는 데이터는 메모리에 올라와 있는 경우도 있지만 그렇지 않은 경우는 디스크에 저장되어 있습니다.
- 인 메모리 형태의 데이터베이스에서는 모든 데이터가 메모리에 적재되어 있고 디스크에 접근하는 과정이 필요없기 때문에 데이터의 처리 성능이 굉장히 빠릅니다.

#### 단순성

- 레디스는 key-value 형태의 구조 뿐만 아니라 List, Set, Sorted Set 등 다양한 데이터 구조를 지원하고 있으며, 임피던스 불일치를 해소하고 개발을 편리하게 할 수 있도록 지원하고 있습니다.

#### 고가용성

- 레디스는 자체적으로 고가용성을 지원하고 있습니다. 복제를 통해 데이터를 여러 서버에 분산시킬 수 있으며 센티널은 장애 상황을 탐지해 자동으로 fail-over를 시킵니다.

#### 확장성

- 레디스를 클러스터 모드로 사용하고 있다면 수평적 확장이 가능합니다.
- 데이터는 레디스 클러스터 내에 자동적으로 샤딩 후 저장되며, 여러개의 복제본이 생성될 수 있습니다.

<br>

## 마이크로서비스 아키텍처와 레디스

#### 데이터 저장소로서의 레디스

- 다양한 자료구조를 지원함으로써 서비스별 요구사항에 맞는 데이터를 저장하기 용이합니다.
- 인 메모리 데이터베이스이기 때문에 데이터를 영구적으로 저장해야하는 경우에는 고민을 해봐야합니다. AOF 기능을 사용할 순 있으나 처리량이 낮아질 수 있습니다.

#### 메시지 브로커로서의 레디스

- 레디스의 pub/sub 기능은 간단한 메시지 브로커의 역할을 수행할 수 있습니다.
- pub/sub에서 발행된 메시지는 소모된 뒤 삭제되는 일회성으로 모든 메시징 상황에서는 적합하진 않지만 fire-and-forget 패턴이 필요한 간단한 알림 기능에서는 적합할 수 있습니다.



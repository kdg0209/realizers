# 리팩토링 기법

- 지속적인 리팩토링은 코드의 품질을 향상시키는 효과적인 수단이지만 리팩토링할 때 코드의 나쁜 냄새와 설계 결함에 대한 통찰력을 기반으로 설계 원칙, 다자인 패턴, 코딩 규칙 등을 합리적이고 능숙하게 사용해야 하는데 이는 어렵기 때문에 더 많은 시간이 소요됩니다.

## 리팩토링의 네 가지 요소

- 일부 개발자가 왜 리팩토링을 해야하는지, 무엇을 리팩토링 해야하는지, 언제 리팩토링을 해야하는지, 어떻게 리팩토링을 해야하는지 잘 모르는데 이번 장에서 살펴 볼 것이다.

#### 1. 목적

- 리팩토링을 함으로써 코드 품질을 보장하는 효과적인 수단이며, 코드 품질 저하흫 효과적으로 방지할 수 있습니다.
- 고품질 코드는 한번에 나오는게 아니라 반복적인 작업의 결과로 나오는 것입니다.
- 리팩토링을 함으로써 오버엔지니어링을 방지할 수 있습니다.
- 코드의 품질을 아무도 책임지지 않는다면 코드는 점점 지저분해지고, 이미 손대기 어려워지기 시작할 때쯤에는 새로운 코드를 작성하는 비용이 많이 들고, 이때는 이미 늦었을 때입니다.

```
마틴 파울러가 제시한 리팩토링의 정의
- 리팩토링은 코드에 대한 이해를 쉽게 하기 위해 소프트웨어의 내부 구조를 개선하는 것으로,
  소프트웨어의 외부 동작을 변경하지 않고 수정 비용을 줄이는 것을 목적으로 한다.
```

#### 2. 대상

- 대규모 리팩토링은 시스템, 모듈, 코드 구조, 쿨래스 간의 관계를 포함하여 최상위 설계를 리팩토링하는 것을 말합니다. 이는 코드 변경이 많고 영향이 크기 때문에 작업이 어렵고 시간이 많이 소요되며, 버그 발생 위험이 증가합니다.
- 소규모 리팩토링은 명명, 주석, 갓 클래스 제거, 중복 코드 제거와 같이 클래스, 메서드, 변수 수준에서 코드 세부 사항을 정리하는 것입니다.

#### 3. 시기

- 코드 품질에 주의를 기울이지 않고, 임의로 코드를 추가 또는 삭제하고, 유지 관리할 수 없는 경우에 리팩토링을 하거나 다시 작성하는 행위는 추천하지 않습니다. 즉 코드가 이미 망가진 후에 모든 문제를 한꺼번에 해결하려는 수단으로 리패토링을 하는게 아니라 지속적인 리팩토링을 해야합니다.
- 개인적인 생각으로 위 내용에 너무 공감을 하고, 처음에 대충 코드를 작성하고 추후에 고품질의 코드를 작성하려고 생각하기 보다는 지속적으로 어떻게 해결해야할까 생각해야합니다.

#### 4. 방법

- 대규모 리팩토링의 경우 범위가 크기 때문에 단계별로 목표를 수립하고 질서있게 진행해야 합니다. 각 단계에서는 리팩토링의 영향을 받는 코드의 범위가 크기 때문에 범위를 제어하고, 기존 코드와 호환성을 고려햐여 진행해야합니다.
- 소규모 리팩토링의 경우 범위가 작고 변경 사항이 적기 때문에 시간이 있을때마다 진행하면 됩니다.

<br>

## 단위 테스트

- 많은 개발자가 지속적인 리팩토링이 필요하다고 생각은 하지만 다른 사람이 작성한 코드를 리팩토링을 할 때 버그가 발생하면 어떡하지? 괜히 내가 수정했다가 잘 못되는거 아닌가? 라는 생각을 하곤합니다. 이때 단위 테스트를 작성함으로써 안정적으로 진행할 수 있습니다.

#### 단위 테스트에 대해 

- Java와 Spring boot를 사용한다면 Junit을 사용하여 단위 테스트를 잘 작성하자.

#### 단위 테스트를 작성하는 이유

1. 단위 테스트를 작성함으써 버그 찾는데 도움이 된다.
2. 단위 테스트는 프로그래머가 코드 설계과정에서 문제를 찾는데 도움을 준다.
3. 단위 테스트는 통합 테스트를 보완하는 강력한 도구다.
4. 단위 테스트를 작성하는 과정은 리팩토링 과정에 해당한다.
5. 단위 테스트는 프로그래머가 코드에 빠르게 익숙해질 수 있도록 한다.
6. 단위 테스트는 TDD를 개선하고 대체할 수 있다.

#### 단위 테스트를 작성하기 어려운 이유

- 처음 단위 테스트를 작성할 때 많은 노력을 해야하지만, 개발 작업이 길어지고 요구사항이 많아질수록 단위 테스트 비중을 낮추게됩니다. 이에따라 '께진 유리창 효과'가 발생하면서 더 이상 단위 테스트를 작성하지 않게됩니다.
- 단위 테스트가 없는 팀에서 단위 테스트를 적용하기 위해서는 새로 작성된 코드부터 단위 테스트를 하나씩 적용해나가며, 이 과정은 리더의 의지만으로 부족하니 팀원들도 강한 주인의식이 있어야합니다.













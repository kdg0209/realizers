# CPU 스케줄링

## CPU 스케줄링 개요
<hr>

- CPU 스케줄링이란 프로세스에게 공정하고 합리적으로 CPU 자원을 배분하는 것입니다.

### 프로세스 우선순위

- 운영체제는 각 프로세스의 PCB에 우선순위를 명시하고, PCB에 명시된 우선순위를 기준으로 먼처 처리할 프로세스를 결정합니다.

#### 입출력 집중 프로세스

- 입출력 집중 프로세스란 비디오 재생이나 디스크 백업 작업 등 입출력 작업이 많은 프로세스입니다.

#### CPU 집중 프로세스

- CPU 집중 프로세스란 수학 연산, 컴파일 등 CPU 작업이 많은 프로세스입니다.

### 스케줄링 큐

<img width="943" alt="스크린샷 2024-01-07 오후 3 27 34" src="https://github.com/kdg0209/realizers/assets/80187200/e055ce27-1df1-462a-91b3-46a503ebc9e9">

### 선점형과 비선점형 스케줄

#### 선점형 스케줄링

- 선점형 스케줄링이란 프로세스가 CPU 자원을 사용하고 있더라도 우선순위가 높은 프로세스에게 CPU 자원을 뺏길 수 있는 스케줄링 방식입니다.
- 선점형 스케줄링 기법은 공유 자원을 사용할 때 race-condition이 발생할 수 있습니다. 그렇기 때문에 뮤텍스나 세마포어 등 동기화 기법을 적용하여 공유 자원에 대해 안전한 처리가 필요합니다.

#### 비선점형 스케줄링

- 비선점형 스케줄링이란 하나의 프로세스가 CPU 자원을 사용하고 있으면 해당 프로세스의 작업이 끝나거나, 대기 상태로 접어들기 전까지 다른 프로세스가 끼어들 수 없는 스케줄링 방식입니다.
- 비선점형 스케줄링 방식을 사용하면 CPU를 독점적으로 사용하는 문제가 발생할 수 있습니다.

<br>

## CPU 스케줄링 알고리즘
<hr>

### 선입 선처리 스케줄링(FCFS 스케줄링)

- 선입 선처리 스케줄링이란 단순히 큐에 적재되어 있는 순서대로 프로세스를 처리하는 비선점형 스케줄링 기법입니다.

#### 장점

- 큐에 적재되어 있는 프로세스들은 결국 실행되므로 기아 현상이 발생하지 않습니다.

#### 단점

- 예를들어 17ms 동안 CPU를 이용하는 프로세스 A, 5ms 동안 CPU를 이용하는 프로세스 B, 2ms 동안 CPU를 이용하는 프로세스 C가 있는 경우 
 프로세스 C가 실행되기 위해서는 22ms라는 시간을 기다려야 하는데 이를 호휘 효과라 합니다.
- 호휘 효과란 CPU를 많이 필요로 하지 않는 프로세스들이 CPU를 오랫동안 사용하는 프로세스를 기다리는 현상입니다.

<br>

### 최단 작업 우선 스케줄링

- 가장 작은 CPU 버스트를 가진 프로세스를 우선순위로 두어 스케줄링 하는 기법입니다. 만약 CPU 버스트가 같다면 선입 선처리 스케줄링 기법이 적용됩니다.

#### 장점

- 항상 실생 시간이 짧은 작업을 우선적으로 실행하므로 평균 대기시간이 짧습니다.

#### 단점

- CPU 버스트의 길이가 긴 프로세스는 기아 현상이 발생할 수 있습니다.
- 실제로 실행 시간을 예측하기 어렵기 때문에 실용적이진 못합니다.

<br>

### 라운드 로빈 스케줄링

- 라운드 로빈 스케줄링은 선입 선처리 스케줄링 기법에 타임 슬라이스 기법이 추가적으로 적용된 기법입니다.
- 프로세스들에 우선 순위를 두지 않고 순서대로, 시간을 나눠 CPU를 사용하는 기법입니다.


#### 장점

- CPU 자원을 공평하게 사용하므로 기아 현상이 발생하지 않습니다.

#### 단점

- 타임 슬라이스가 너무 짧다면 context-switch가 너무 자주 발생하여 오버헤드가 증가합니다.
- 타임 슬라이스가 너무 길다면 호휘 효과가 발생할 수 있습니다.

<br>

### 최소 잔여 시간 우선 스케줄링

- 최소 잔여 시간 우선 스케줄링이란 최단 작업 우선 스케줄링과 라운드 로빈 스케줄링을 합친 스케줄링 기법입니다.
- 최소 잔여 시간 우선 스케줄링에서 프로세스들은 정해진 타임 만큼 CPU를 사용하되, CPU를 사용할 다음 프로세스로는 남아있는 작업 시간이 가장 작은 프로세스가 선택됩니다.

<br>

### 우선순위 스케줄링

- 우선순위 스케줄링이란 프로세스에게 우선순위를 부여하고, 해당 우선순위 중에서 가장 높은 우선순위를 가진 프로세스부터 작업을 처리하는 기법입니다.

#### 장점

- 프로세스마다 상대적 중요성을 정의할 수 있습니다.

#### 단점

- 우선순위가 높은 프로세스가 계속해서 준비 큐에 삽입된다면 우선 순위가 낮은 프로세스에 기아 현상이 발생할 수 있습니다.
- 기아 현상이 발생하면 에이징을 사용하여 특정 프로세스의 우선순위를 점진적으로 높일 수 있습니다.

<br>

### 다단계 큐 스케줄링

- 우선순위마다 준비 큐를 형성해 놓는 방식입니다.
- 각 큐는 별도의 스케줄링 기법을 적용할 수 있습니다. 또한 큐 사이에도 스케줄링 기법을 적용할 수 있습니다.
- 우선순위가 높은 큐에 존재하는 프로세스부터 실행되며, 우선 순위가 높은 큐들이 비어있지 않다면 다음 우선순위 큐를 실행시킬 수 없습니다.
- 큐에 적재되어 있는 프로세스는 다른 우선순위 큐에 재배치 될 수 없습니다.

#### 장점

- 큐를 여러개 둠으로써 프로세스 유형별로 우선순위를 구분하여 실행시키는게 편리합니다.

#### 단점

- 우선순위가 낮은 큐에 적재되어 있는 프로세스들에 기아 현상이 발생할 수 있습니다.

<img width="1135" alt="스크린샷 2024-01-07 오후 3 28 00" src="https://github.com/kdg0209/realizers/assets/80187200/ddaac566-97d0-4144-8d6f-4ca28cb0548e">

<br>
<br>

### 다단계 피드백 큐 스케줄링

- 다단계 큐 스케줄링에서는 프로세스들이 큐 사이를 이동할 수 없었는데, 이러한 방식에서는 우선순위가 낮은 프로세스들은 계속 연기될 수 있습니다. 즉 기아 현상이 발생할 수 있는데
이를 보완한 스케줄링이 다단계 피드백 큐 스케줄링 기법입니다.
- 즉 프로세스들이 큐 사이를 이동할 수 있습니다.
- 프로세스 생성시 우선순위가 가장 높은 큐에 적재됩니다. 그리고 해당 프로세스는 선입 선출 순서로 CPU 자원을 이용하게 됩니다. 그리고 해당 큐의 CPU 시간 할당량이 끝나면 한 단계 아래 큐로 적재됩니다.
- 프로세스들은 큐 사이를 이동할 수 있기 때문에 낮은 우선순위 큐에서 너무 오래 기다리고 있는 프로세스가 있다면 점차 우선순위가 높은 큐로 이동시키는 에이징 기법을 적용하여 기아 현상을 예방할 수 있습니다.

<img width="670" alt="스크린샷 2024-01-07 오후 3 28 16" src="https://github.com/kdg0209/realizers/assets/80187200/b18afa91-adc4-4105-9e20-d98dd5add43a">

<br>
<br>

### 🤔 생각해볼 수 있는 질문들

1. 입출력 작업이 많은 프로세스를 우선적으로 실행시키는게 왜 더 효율적인가?
2. 선점형 스케줄링 방식과 비선점형 스케줄링 방식이 무엇인가?
3. 선점형 스케줄링 방식과 비선점형 스케줄링 방식의 장단점이 무엇인가?
4. 선입 선처리 스케줄링 기법이 무엇인가?
5. 선입 선처리 스케줄링의 장점과 단점이 무엇인가?
6. 최단 작업 우선 스케줄링 기법이 무엇인가?
7. 최단 작업 우선 스케줄링의 장점과 단점이 무엇인가?
8. 라운드 로빈 스케줄링 기법이 무엇인가?
9. 라운드 로빈 스케줄링의 장점과 단점이 무엇인가?
10. 최소 잔여 시간 우선 스케줄링 기법이 무엇인가?
11. 기아 현상을 방지하기 위해서 어떻게 해결할 수 있는가?
12. 다단계 큐 스케줄링이란 무엇인가?
13. 다단계 피드백 큐 스케줄링이란 무엇인가?



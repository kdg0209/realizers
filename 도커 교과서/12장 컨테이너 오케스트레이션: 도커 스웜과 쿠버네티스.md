# 컨테이너 오케스트레이션: 도커 스웜과 쿠버네티스

<br>

## 1. 컨테이너 오케스트레이션 도구란?

- 운영 환경에서는 하나의 컨테이너만 실행시키는 것이 아니라 여러대의 컨테이너를 실행시켜 고가용성을 뒷받침할 수 있도록 해야합니다. 그렇기 때문에 오케스트레이션이 필요합니다.

### 1-1. 오케스트레이션 도구

- 오케스트레이션 도구는 여러 컨테이너의 관리와 조율을 자동화하는 것입니다.
- 네트워크 트래픽 부하를 고르게 분산시키고, 상태가 불량한 컨테이너를 새 컨테이너로 교체하며, 컨테이너 프로비저닝, 배포, 업데이트, 컨테이너간 리소스 배정, 컨테이너 모니터링 등과 같은 작업을 제어하고 자동화할 수 있는 도구입니다.

#### 예시

- 클러스터에 애플리케이션을 배포하려면 클러스터에 YAML 파일을 전달하면 됩니다. 그럼 클러스터가 애플리케이션 구성 정보를 저장하고, 그에 맞춰 사용 가능한 서버에서 컨테이너를 생성해 애플리케이션을 실행하게 됩니다. 애플리케이션이 실행되면 클러스터는 애플리케이션의 실행 상태가 유지되도록 관리합니다. 만약 어떤 컨테이너의 애플리케이션에 문제가 발생하면 클러스터가 다른 컨테이너로 대체하게 됩니다.

![스크린샷 2024-11-29 오후 10 28 54](https://github.com/user-attachments/assets/5a638941-8e52-44f0-879f-2f33a2f6a66d)

<br>

### 1-2. 도커 스웜의 구조

- 스웜 모드는 "매니저 노드"와 "워커 노드"로 구성되어 있습니다. 매니저 노드는 여러 워커 노드들을 관리하기 위한 노드입니다.
- 매니저 노드
  - 매니저 노드는 여러 워커 노드들을 관리하기 위한 노드입니다. 매니저 노드도 워커 노드처럼 컨테이너는 생성할 수 있습니다.
  - 워커 노드는 0개일 수 있지만 매니저 노드는 반드시 최소한 1개는 있어야 하며, 매니저 노드가 워커 노드의 역할도 할 수 있기 때문에 워커 노드가 0개여도 됩니다. 하지만 운영 환경에서는 이를 구분해서 사용하는게 권장됩니다.
- 워커 노드
  - 워커 노드는 실제 컨테이너가 생성되어 운영되는 서버입니다. 주기적으로 상태를 매니저 노드에게 보고해야 합니다.

![스크린샷 2024-11-29 오후 10 45 07](https://github.com/user-attachments/assets/12a0b734-ae5e-4135-9059-d7767dff262b)

<br>

### 1-3. 도커 스웜의 주요 용어

#### 노드

- 클러스터를 구성하는 개별 도커 서버를 의미합니다.
- 보통 하나의 서버에 하나의 도커 데몬을 실행시키기 때문에 노드는 곧 서버라할 수 있습니다.

#### 매니저 노드

- 클러스터 관리와 오케스트레이션을 담당하며, 쿠버네티스의 마스터 노드와 같은 역할입니다.

#### 워커 노드

- 컨테이너 기반 서비스들이 실제 구동되는 노드를 의미합니다.

#### 스택

- 하나 이상의 서비스로 구성된 다중 컨테이너 애플리케이션 묶음을 의미합니다.
- 도커 컴포즈와 유사한 양식의 YAML 파일로 스택을 배포합니다.

#### 서비스

- 노드에서 수행하고자 하는 작업을 정의해 놓은 것입니다.
- 도커 스웜에서는 기본적인 배포 단위로 취급됩니다. 하나의 서비스는 하나의 이미지를 기반으로 구동됩니다.

#### 

<br>

## 2. 도커 스웜으로 클러스터 만들기




















<br>

참고

- https://seongjin.me/docker-swarm-introduction-nodes/


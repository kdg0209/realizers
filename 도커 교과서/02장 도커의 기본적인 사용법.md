# 도커의 기본적인 사용법

<br>

## 1. 컨테이너란 무엇인가?

- 컨테이너란 호스트 OS상에서 각각의 구역을 만들고, 애플리케이션을 실행시키기 위해 필요한 라이브러리나 IP 주소, 디스크 등을 하나로 모아 마치 별도의 서버인거처럼 사용할 수 있도록 만든 것입니다.
- 도커 컨테이너를 사용하면 Host OS에서 구동되므로 다른 운영체제는 사용할 수 없습니다. 즉 도커 컨테이너는 호스트 컴퓨터의 운영체제를 공유하게 됩니다.
- 호스트 OS의 자원을 논리적으로 분리시키고, 여러 개의 컨테이너들이 공유하여 해당 자원을 사용합니다. 이러한 컨테이너들은 오버헤드가 적고 가볍습니다.
- 컨테이너를 사용하면 OS나 디렉토리, IP 주소 등과 같은 시스템 자원을 마치 각각의 애플리케이션이 점유하고 있는거처럼 보이게 할 수 있습니다.

![스크린샷 2024-10-28 오후 11 20 48](https://github.com/user-attachments/assets/c666214c-fbc7-4779-b74f-9cae91473c5f)

#### 하이퍼바이저 가상화

- 도커 컨테이너와 가장 많이 비교되는 가상화 기법이 하이퍼바이저 가상화 기법인데, 하이퍼바이저 가상화를 사용하면 하나의 운영체제에서 여러 운영체제를 동시에 사용할 수 있습니다.
- 하이퍼바이저 가상화 기법은 호스트 OS 위에 Guest OS를 설치하여 작동됩니다. 즉 Host OS는 리눅스이지만 Guest OS를 윈도우로 설정하면 윈도우 운영체제를 사용할 수 있는 것입니다.
- 각각의 가상 머신은 자신만의 운영체제를 별도로 갖습니다. 따라서 CPU와 메모리 자원을 많이 사용하게 됩니다.

![스크린샷 2024-10-28 오후 10 51 51](https://github.com/user-attachments/assets/ef977fcd-a6da-43fa-a6cb-abdaeb904280)

<br>

## 2. 컨테이너의 상태

#### Exited 상태

- 컨테이너 내부의 애플리케이션이 실행중이어야 컨테이너의 상태도 실행 중이 될 수 있습니다. 즉 애플리케이션이 종료되면 컨테이너의 상태도 Exited가 됩니다. 종료된 컨테이너는 CPU 자원이나 메모리를 사용하지 않습니다.
- 컨테이너가 종료되더라도 컨테이너는 사라지지 않습니다. 종료된 컨테이너는 그대로 남아있으며, 나중에 컨테이너를 재시작하거나 로그 확인 및 inspect 명령어를 통해 더 자세히 확인할 수 있습니다.
- 하지만 남아있는 컨테이너들은 호스트 컴퓨터의 디스크 공간을 계속 점유하게 됩니다.

<br>

## 3. 도커가 컨테이너를 실행하는 원리

- 사용자가 docker container run ...과 같은 명령어를 입력하면 도커가 어떻게 컨테이너를 실행하게 되는지 살펴봅니다.

#### 도커 CLI

- 우리가 docker 명령어를 사용할 때 해당되는것이 바로 도커 CLI입니다. 도커 CLI를 통해 도커 API에게 요청을 보내게 됩니다.

#### 도커 API

- 도커 엔진은 도커 API로부터 전달받은 기능을 수행하게 됩니다. 그리고 도커 API는 표준 HTTP 기반 REST API입니다.

#### 도커 엔진

- 도커 엔진은 도커의 관리 기능을 맡는 컴포넌트입니다. 호스트 운영체제와 함께 컨테이너와 가상 네트워크 등 도커 리소스를 만드는 일도 담당합니다.
- 우리가 어떠한 이미지를 다운받을 때, 로컬 이미지 캐시를 확인하게 되며 로컬 이미지 캐시에 있다면 해당 이미지를 사용하게 되고, 그렇지 않다면 다운로드가 되는 것입니다.
- 도커 엔진은 백그라운드 프로세스로 항시 동작하고 있습니다.

![스크린샷 2024-10-29 오후 10 06 24](https://github.com/user-attachments/assets/fa662d1d-382e-4372-8ad1-7017a65d4268)

<br>

## 4. 이미지로 컨테이너를 만드는 과정

#### 🚗 실행 과정

1. 우리가 "docker run java-container"와 같은 명령어를 입력했다고 가정합시다. 그럼 아래와 같은 과정을 거치게 됩니다.
2. 도커 컨테이너가 하나 생성됩니다.
3. 이미지에 있는 "파일 스냅샷"을 도커 컨테이너의 하드 디스크에 적재시킵니다.
4. 이미지에 있는 "시작시 실행될 명령어(java jar /app.jar)"를 도커 컨테이너가 실행하게 됩니다. 그럼 도커 컨테이너의 하드 디스크에 적재되어 있던 스냅샷을 실행시키게 됩니다.

```text
> docker run java-container
```

![스크린샷 2024-10-30 오후 9 44 22](https://github.com/user-attachments/assets/b9494bd2-912a-4fe3-b028-e92ff050d632)


